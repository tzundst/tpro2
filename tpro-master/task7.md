## Задание №7

## Кодирование ПО

### Зависимости: [Задание 1][task-1], [VM][task-vm], [Задание 5][task-5].

С использованием CLion необходимо разработать программу, реализующую представленные ниже сценарии. Фактически это внешняя спецификация программы.

Работать необходимо в том же каталоге, куда вы загрузили свой проект с GitLab. (По умолчанию это `~/Desktop/tpro`). **Каталог программы `task7`**. В дальнейшем необходимо придерживаться такого наименования папок проекта и не допускать различных наименований, чтобы преподаватель не путался во всем разнообразии ваших проектов. В данном случае это каталог седьмого задания.

Необходимо отредактировать существующий файл `CMаkeLists.txt`, **добавив** туда дополнительно информацию о новой конфигурации `task7_main` в дополнение к `example_main` и `example_test`.

**НЕ СОЗДАВАТЬ новый проект в CLion**, а в текущем проекте `tpro` добавить новую конфигурацию`task7_main`.

В процессе разработки программы не забывайте периодически сохранять ее на сервере с использованием команд `git`.

Разработанная программа будет использоваться при выполнении следующего задания по тестированию. Загрузка кода одномоментно целиком означает отсутствие использования системы контроля версий Git при своей работе, оценка за это будет снижаться.

Реализацию необходимо вести методом сверху-вниз структорного подхода программирования, то есть у вас должны быть сразу реализованы функции-заглушки, отвечающие внешнему интерфейсу, чтобы в условиях ограниченного времени разработки вы смогли реализовать три функции, которые в дальнейшем будут использоваться для тестирования.
Если вы что-то не успели реализовать за отведенное время, то это будет выявлено вами же как ошибка программы при тестировании в рамках следующего задания.

Программа должна состоять минимум из двух файлов:
- `task7.cpp` (и, возможно, `task7.h`) - содержит описание и реализацию функций (описаны далее)
- `main7.cpp` - содержит функцию `main` и реализацию меню, которое вызывает соответствующие функции.

Кроме этого для проверки программы потребуются дополнительные файлы с данными. Файлы необходимо расположить в подкаталоге **`data`** каталога `task7`. Количество файлов и их название остаются на усмотрение исполнителя.

Для удобства работы с именами файлов можно установить **рабочую директорию проекта**, по умолчанию программа ищет файлы в каталоге, в котором компилируется исполняемый файл (где-то в cmake-build-debug). Чтобы не прописывать длинный путь ко всем файлам на вкладке `Run -> Edit configurations` для конфигурации задания в поле "Working directory", укажите путь к каталогу с файлами `/home/user/Desktop/tpro/task7/data`

При выполнении задания **необходимо использовать систему контроля версий Git**, описание каждого коммита **должно** содержать название задания **task7** и описание изменений в коммите. Частота коммитов - на усмотрение разработчика, но содержимое коммитов должно показывать работу над заданием, если это будет просто загрузка кода кусками, то **оценка будет снижаться**.
 
#### Варианты испльзования / Внешняя спецификация разрабатываемой программы

Программа должна представлять из себя консольное приложение с меню, работающим в **бесконечном цикле**, меню должно сдержать пункт выхода из программы, а также пункты меню, реализующие нижеприведенные варианты использования. Каждый вариант использования реализован в виде отдельной функции, которая принимает на вход некоторые параметры и возвращает некоторое параметры. Ввод необходимых для работы функции значений параметров с клавиатуры и передача их в функцию осуществляется там же, где реализуется само меню (`main7.cpp`). **Ввод с клавиатуры и вывод на экран внутри функций запрещен (~~cin, cout,cerr~~)**, работа с функциями только через параметры.
Для вывода на экран использовать стандартные потоки, для работы с файлами использовать файловые потоки.

##### 1. Копирование текстовых файлов. 
- Ввести имя входного и выходного текстовых файлов
- Вызвать функцию копирования файлов
- Вывести на экран количество скопированных строк или ошибку

Входные параметры для функции:
- имя входного файла, файл должен быть текстовым
- имя выходного файла

Возвращаемое значение функции:
- количество скопированных строк или код ошибки (отрицательное число) в случае невозможности открытия файлов.

Функция должна производить построчное чтение из входного файла и запись в выходной файл. **Если выходной файл не существует**, то он должен создаваться. **Если выходной файл существует**, то информация в него **дописывается**. 

##### 2. Суммирование положительных чисел с плавающей точкой из файла (любого количества)

- Ввести имя входного файла
- Вызвать функцию суммирования чисел из файла
- Вывести на экран сумму чисел или ошибку

Входные параметры для функции:
- имя входного файла, файл должен быть текстовым и содержать положительные числа с плавающей точкой, **разделенные пробелом или переводом строки**, отделение дробной части может быть **как через точку, так и через запятую**. Файл должен содержать только числа в указанном формате

Возвращаемое значение функции:
- сумма чисел из файла или код ошибки (отрицательное число) в случае наличия в файле отрицательных чисел или нечисел

Функция должна просуммировать положительные числа, хранящиеся в файле

##### 3. Шифрование файла

- Ввести имя входного и выходного файла
- Ввести ключ шифрования (строка)
- Вызвать функцию шифрования файла с использованием ключа и сохранением в выходной файл
- Вывести на экран количество зашифрованных байт или ошибку

Входные параметры для функции:
- имя входного файла
- имя выходного файла
- ключ шифрования (строка)

Возвращаемое значение:
- количество байт, записанных в выходной файл или код ошибки (отрицательное число) в случае невозможности открытия файлов или пустого ключа.

Функция шифрует входной файл с использованием ключа и операции "исключающее или" (XOR) и записывает результат в выходной файл, при этом **если выходной файл существует, то он перезаписывается**. Ключ необходимо использовать циклически, то есть если, например, ключ состоит из 3-х байт, то первый байт файла шифруется первым байтом ключа, второй - вторым, третий - третьим, четвертый - первым, пятый - вторым и т.д. **Если выходной файл не существует, то он должен создаваться**.

#### Условия

В случае вознкиновения ошибок на экран выводить не только код ошибки, но и текстовое описание. Коды ошибок можно выбрать любые, но они должны позволять различать в дальнейшем ошибки - отсутствие входного или выходного файла, чисел в файле, пустой ключ и т.д.

Разработанные функции данной программы будут в дальнейшем испоьзоваться для разработки тестов в последующем задании.

Если текущее задание реализовано не полностью, то это будет выявлено в дальнейшем при составлении тестов для программы. Если какая-то из функций не реализована вообще, то необходимо создать пустую "функцию-заглушку", имеющую правильный интерфейс, но не выполняющую функционал.

**Сдачу задания можно осуществлять удаленно**, для этого в issue, необходимо прикрепить скриншоты, показывающие работу программы с файлами данных и результатов, при этом из скриншотов должно быть понятно какие файлы используются и данные файлы должны быть в каталоге **data** вашего проекта. На скриншоте желательно отображать не только консоль работы с приложением, но и и содержимое файлов. Необходимо использовать разные файлы для разных функций, по крайней мере выходные файлы, чтобы результат выполнения функций не перезаписывал друг друга и сохранялся в отдельных файлах и, следовательно, в репозитории. Возможно, потребуется несколько скриншотов и несколько файлов для демонстрации работы одной функции, чтобы продемонстрировать **все** требуемые варианты использования по заданию. **Все** файлы - входные и выходные данные должны быть добавлены в проект и загружены на сервер для возможности проверки содержимого преподавателем. Кроме этого, эти файлы с данными можно будет использовать в следующем задании, для проведения автоматизированного тестирования функций.

**Примечание по скриншотам**: Необходимо комментировать, что происходит на скриншотах - если вы хагружаете их через designs, то комментарии можно оставлять к каждому скриншоту. Если загружаете в текст, то тогда нужно комментировать в тексте.

#### **Распространенные ошибки**. 
* Не демонстрируется дозапись файла для первой функции
* Не демонстрируется перезапись файла для третьей функции. Для возможности демонстрации правильности шифрования третьей функцией необходимо произвести шифрование два раза и использовать три файла: шифрование первого файла во второй, шифрование второго файла в третий. При этом первый и третий файлы должны совпасть (потому что XOR). Убедиться в правильности шифрования можно, набрав в консоли команду `diff файл1 файл3` - файлы должны совпасть.
* Не демонстрируется поведение программы при ошибках - отсутствии файлов, неправильном формате и т.п.

Для удаленной сдачи задания создать в **своем** проекте **issue "Сдача task7"** и назначить его преподавателю (Assignee). Без назначения он его не увидит!

Если задание принято, то issue закрывается, если есть замечания, то преподаватель ответит вам в issue и переназначит вам обратно.

[task-1]: ./task1.md
[task-5]: ./task5.md
[task-vm]: ./task_vm_prepare.md